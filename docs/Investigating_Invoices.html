<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Investigating_Invoices.knit</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">An Online Retailer Investigation</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Introduction &amp; Data Wrangling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./An_Introduction_to_the_Data.html">Data Frame Presentation &amp; Basic Checks</a>
    </li>
    <li>
      <a href="./Data_Wrangling_Part1_-data_cleaning-.html">Data Wrangling Part 1 (data cleaning)</a>
    </li>
    <li>
      <a href="./Data_Wrangling_Part2_-missing_values_duplicated_rows-.html">Data Wrangling Part 2 (missing values &amp; duplicated rows)</a>
    </li>
    <li>
      <a href="./Data_Wrangling_Part3a_-Quantity-outliers-.html">Data Wrangling Part 3a (outliers for Quantity)</a>
    </li>
    <li>
      <a href="./Data_Wrangling_Part3b_-Price-outliers-.html">Data Wrangling Part 3b (outliers for Price)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Extracting Insights
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Investigating_Invoices.html">Investigating Invoices</a>
    </li>
    <li>
      <a href="./Investigating_Items.html">Investigating Items</a>
    </li>
    <li>
      <a href="./Investigating_Customers.html">Investigating Customers</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Advanced Inquiries
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Analyzing_Sales_Trends.html">Analyzing Sales Trends</a>
    </li>
    <li>
      <a href="./Market_Basket_Analysis.html">Market Basket Analysis</a>
    </li>
    <li>
      <a href="./Customers_Segmentation.html">Customers' Segmentation</a>
    </li>
    <li>
      <a href="./Understanding_Cancellations.html">Understanding Cancellations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboards
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Data_Presentation.html">Data Presentation</a>
    </li>
    <li>
      <a href="./Insights_Presentation.html">Insights Presentation</a>
    </li>
    <li>
      <a href="./Inquiries_Presentation.html">Inquiries Presentation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<p>After having manipulated our data frame in the previous section of
the site, removing rows that are not pertinent transactions and
exploring missing values, duplication and limit cases, we will here
start to interrogate the data, using standard data analysis techniques,
with the goal to extract information that can be used for business
purposes.</p>
<p><br></p>
<div id="focus-of-this-document" class="section level1">
<h1>- <em>focus of this document</em></h1>
<p>In this document we will investigate the invoices, with a focus on
the phenomenon of the cancelled ones. Cancelled invoices can be very
concerning as they represent lost sales so we will try to understand how
widespread they are and to quantify the lost revenues.</p>
<p>We decided not to remove <a
href="https://pykaalexandro.github.io/An-Online-Retailer-Investigation/Data_Wrangling_Part2_-missing_values_duplicated_rows-.html#-_duplicated_rows">duplicated
rows</a>, as we prefer not to lose information about quantity even if
that might inflate the number of purchases.</p>
<p><br></p>
</div>
<div id="basic-breakdown" class="section level1">
<h1>- <em>basic breakdown</em></h1>
<p>We can begin by reminding their basic figures: how many there are and
how many of them have been cancelled.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Number of Invoices&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Number of Cancelled Invoices&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice[<span class="fu">str_starts</span>(Invoice, <span class="st">&quot;C&quot;</span>)]),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Percentage =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">Number of Cancelled Invoices</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Total Number of Invoices</span><span class="st">`</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Total Number of Invoices"],"name":[1],"type":["int"],"align":["right"]},{"label":["Number of Cancelled Invoices"],"name":[2],"type":["int"],"align":["right"]},{"label":["Percentage"],"name":[3],"type":["formttbl"],"align":["right"]}],"data":[{"1":"24680","2":"4107","3":"16.64%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><br></p>
<p>We can then continue by showing the number of invoices per day,
differentiating by status.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">InvoiceDay =</span> <span class="fu">as.Date</span>(InvoiceDate)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(InvoiceDay, Status) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Invoices per Day&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Status, <span class="at">values_from =</span> <span class="st">`</span><span class="at">Number of Invoices per Day</span><span class="st">`</span>, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Confirmed, <span class="at">.before =</span> Cancelled)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["InvoiceDay"],"name":[1],"type":["date"],"align":["right"]},{"label":["Confirmed"],"name":[2],"type":["int"],"align":["right"]},{"label":["Cancelled"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"2009-12-01","2":"117","3":"37"},{"1":"2009-12-02","2":"115","3":"12"},{"1":"2009-12-03","2":"124","3":"13"},{"1":"2009-12-04","2":"88","3":"12"},{"1":"2009-12-05","2":"30","3":"0"},{"1":"2009-12-06","2":"74","3":"16"},{"1":"2009-12-07","2":"101","3":"13"},{"1":"2009-12-08","2":"105","3":"55"},{"1":"2009-12-09","2":"87","3":"10"},{"1":"2009-12-10","2":"91","3":"26"},{"1":"2009-12-11","2":"70","3":"47"},{"1":"2009-12-13","2":"71","3":"6"},{"1":"2009-12-14","2":"87","3":"20"},{"1":"2009-12-15","2":"98","3":"8"},{"1":"2009-12-16","2":"98","3":"5"},{"1":"2009-12-17","2":"103","3":"52"},{"1":"2009-12-18","2":"66","3":"8"},{"1":"2009-12-20","2":"34","3":"6"},{"1":"2009-12-21","2":"40","3":"9"},{"1":"2009-12-22","2":"45","3":"21"},{"1":"2009-12-23","2":"22","3":"3"},{"1":"2010-01-04","2":"27","3":"12"},{"1":"2010-01-05","2":"36","3":"4"},{"1":"2010-01-06","2":"14","3":"0"},{"1":"2010-01-07","2":"47","3":"36"},{"1":"2010-01-08","2":"42","3":"1"},{"1":"2010-01-10","2":"34","3":"3"},{"1":"2010-01-11","2":"54","3":"6"},{"1":"2010-01-12","2":"38","3":"4"},{"1":"2010-01-13","2":"28","3":"16"},{"1":"2010-01-14","2":"57","3":"23"},{"1":"2010-01-15","2":"45","3":"4"},{"1":"2010-01-17","2":"40","3":"1"},{"1":"2010-01-18","2":"40","3":"6"},{"1":"2010-01-19","2":"46","3":"3"},{"1":"2010-01-20","2":"35","3":"32"},{"1":"2010-01-21","2":"48","3":"15"},{"1":"2010-01-22","2":"43","3":"4"},{"1":"2010-01-24","2":"50","3":"2"},{"1":"2010-01-25","2":"57","3":"6"},{"1":"2010-01-26","2":"56","3":"12"},{"1":"2010-01-27","2":"56","3":"15"},{"1":"2010-01-28","2":"55","3":"14"},{"1":"2010-01-29","2":"48","3":"19"},{"1":"2010-01-31","2":"53","3":"4"},{"1":"2010-02-01","2":"63","3":"7"},{"1":"2010-02-02","2":"45","3":"10"},{"1":"2010-02-03","2":"49","3":"7"},{"1":"2010-02-04","2":"62","3":"2"},{"1":"2010-02-05","2":"39","3":"24"},{"1":"2010-02-07","2":"30","3":"5"},{"1":"2010-02-08","2":"58","3":"5"},{"1":"2010-02-09","2":"54","3":"2"},{"1":"2010-02-10","2":"31","3":"5"},{"1":"2010-02-11","2":"56","3":"7"},{"1":"2010-02-12","2":"32","3":"6"},{"1":"2010-02-14","2":"45","3":"5"},{"1":"2010-02-15","2":"44","3":"4"},{"1":"2010-02-16","2":"61","3":"10"},{"1":"2010-02-17","2":"48","3":"8"},{"1":"2010-02-18","2":"63","3":"23"},{"1":"2010-02-19","2":"58","3":"4"},{"1":"2010-02-21","2":"37","3":"23"},{"1":"2010-02-22","2":"48","3":"6"},{"1":"2010-02-23","2":"47","3":"9"},{"1":"2010-02-24","2":"63","3":"10"},{"1":"2010-02-25","2":"67","3":"21"},{"1":"2010-02-26","2":"36","3":"11"},{"1":"2010-02-28","2":"53","3":"5"},{"1":"2010-03-01","2":"58","3":"4"},{"1":"2010-03-02","2":"55","3":"33"},{"1":"2010-03-03","2":"62","3":"15"},{"1":"2010-03-04","2":"73","3":"15"},{"1":"2010-03-05","2":"81","3":"0"},{"1":"2010-03-07","2":"56","3":"4"},{"1":"2010-03-08","2":"75","3":"6"},{"1":"2010-03-09","2":"56","3":"16"},{"1":"2010-03-10","2":"61","3":"18"},{"1":"2010-03-11","2":"48","3":"5"},{"1":"2010-03-12","2":"36","3":"6"},{"1":"2010-03-14","2":"24","3":"1"},{"1":"2010-03-15","2":"56","3":"12"},{"1":"2010-03-16","2":"45","3":"44"},{"1":"2010-03-17","2":"48","3":"5"},{"1":"2010-03-18","2":"84","3":"7"},{"1":"2010-03-19","2":"54","3":"12"},{"1":"2010-03-21","2":"56","3":"6"},{"1":"2010-03-22","2":"56","3":"28"},{"1":"2010-03-23","2":"67","3":"8"},{"1":"2010-03-24","2":"68","3":"35"},{"1":"2010-03-25","2":"79","3":"6"},{"1":"2010-03-26","2":"61","3":"11"},{"1":"2010-03-28","2":"58","3":"1"},{"1":"2010-03-29","2":"85","3":"8"},{"1":"2010-03-30","2":"70","3":"34"},{"1":"2010-03-31","2":"75","3":"11"},{"1":"2010-04-01","2":"77","3":"4"},{"1":"2010-04-06","2":"55","3":"5"},{"1":"2010-04-07","2":"61","3":"5"},{"1":"2010-04-08","2":"85","3":"6"},{"1":"2010-04-09","2":"51","3":"2"},{"1":"2010-04-11","2":"42","3":"2"},{"1":"2010-04-12","2":"44","3":"36"},{"1":"2010-04-13","2":"51","3":"32"},{"1":"2010-04-14","2":"45","3":"16"},{"1":"2010-04-15","2":"63","3":"4"},{"1":"2010-04-16","2":"42","3":"5"},{"1":"2010-04-18","2":"54","3":"2"},{"1":"2010-04-19","2":"74","3":"7"},{"1":"2010-04-20","2":"66","3":"7"},{"1":"2010-04-21","2":"64","3":"6"},{"1":"2010-04-22","2":"77","3":"49"},{"1":"2010-04-23","2":"56","3":"3"},{"1":"2010-04-25","2":"46","3":"4"},{"1":"2010-04-26","2":"98","3":"3"},{"1":"2010-04-27","2":"79","3":"19"},{"1":"2010-04-28","2":"73","3":"5"},{"1":"2010-04-29","2":"84","3":"12"},{"1":"2010-04-30","2":"48","3":"29"},{"1":"2010-05-02","2":"40","3":"1"},{"1":"2010-05-04","2":"51","3":"28"},{"1":"2010-05-05","2":"81","3":"29"},{"1":"2010-05-06","2":"82","3":"27"},{"1":"2010-05-07","2":"66","3":"7"},{"1":"2010-05-09","2":"62","3":"2"},{"1":"2010-05-10","2":"76","3":"30"},{"1":"2010-05-11","2":"65","3":"5"},{"1":"2010-05-12","2":"64","3":"6"},{"1":"2010-05-13","2":"66","3":"19"},{"1":"2010-05-14","2":"48","3":"51"},{"1":"2010-05-16","2":"44","3":"3"},{"1":"2010-05-17","2":"48","3":"22"},{"1":"2010-05-18","2":"63","3":"19"},{"1":"2010-05-19","2":"61","3":"8"},{"1":"2010-05-20","2":"67","3":"17"},{"1":"2010-05-21","2":"51","3":"18"},{"1":"2010-05-23","2":"49","3":"4"},{"1":"2010-05-24","2":"71","3":"5"},{"1":"2010-05-25","2":"58","3":"22"},{"1":"2010-05-26","2":"94","3":"15"},{"1":"2010-05-27","2":"87","3":"9"},{"1":"2010-05-28","2":"58","3":"37"},{"1":"2010-05-30","2":"32","3":"3"},{"1":"2010-06-01","2":"46","3":"6"},{"1":"2010-06-02","2":"45","3":"3"},{"1":"2010-06-03","2":"66","3":"37"},{"1":"2010-06-04","2":"51","3":"3"},{"1":"2010-06-06","2":"68","3":"5"},{"1":"2010-06-07","2":"103","3":"10"},{"1":"2010-06-08","2":"77","3":"13"},{"1":"2010-06-09","2":"68","3":"19"},{"1":"2010-06-10","2":"63","3":"32"},{"1":"2010-06-11","2":"79","3":"4"},{"1":"2010-06-13","2":"70","3":"8"},{"1":"2010-06-14","2":"57","3":"15"},{"1":"2010-06-15","2":"51","3":"14"},{"1":"2010-06-16","2":"80","3":"11"},{"1":"2010-06-17","2":"73","3":"15"},{"1":"2010-06-18","2":"49","3":"7"},{"1":"2010-06-20","2":"26","3":"1"},{"1":"2010-06-21","2":"44","3":"1"},{"1":"2010-06-22","2":"42","3":"3"},{"1":"2010-06-23","2":"68","3":"1"},{"1":"2010-06-24","2":"72","3":"33"},{"1":"2010-06-25","2":"42","3":"2"},{"1":"2010-06-27","2":"55","3":"7"},{"1":"2010-06-28","2":"69","3":"9"},{"1":"2010-06-29","2":"70","3":"7"},{"1":"2010-06-30","2":"78","3":"53"},{"1":"2010-07-01","2":"84","3":"9"},{"1":"2010-07-02","2":"44","3":"8"},{"1":"2010-07-04","2":"21","3":"1"},{"1":"2010-07-05","2":"85","3":"24"},{"1":"2010-07-06","2":"58","3":"5"},{"1":"2010-07-07","2":"77","3":"8"},{"1":"2010-07-08","2":"69","3":"9"},{"1":"2010-07-09","2":"30","3":"13"},{"1":"2010-07-11","2":"28","3":"1"},{"1":"2010-07-12","2":"49","3":"7"},{"1":"2010-07-13","2":"55","3":"6"},{"1":"2010-07-14","2":"61","3":"43"},{"1":"2010-07-15","2":"78","3":"4"},{"1":"2010-07-16","2":"67","3":"34"},{"1":"2010-07-18","2":"40","3":"2"},{"1":"2010-07-19","2":"58","3":"6"},{"1":"2010-07-20","2":"57","3":"4"},{"1":"2010-07-21","2":"54","3":"26"},{"1":"2010-07-22","2":"78","3":"12"},{"1":"2010-07-23","2":"47","3":"7"},{"1":"2010-07-25","2":"53","3":"5"},{"1":"2010-07-26","2":"61","3":"13"},{"1":"2010-07-27","2":"70","3":"9"},{"1":"2010-07-28","2":"64","3":"18"},{"1":"2010-07-29","2":"69","3":"23"},{"1":"2010-07-30","2":"50","3":"17"},{"1":"2010-08-01","2":"30","3":"6"},{"1":"2010-08-02","2":"62","3":"6"},{"1":"2010-08-03","2":"56","3":"22"},{"1":"2010-08-04","2":"52","3":"9"},{"1":"2010-08-05","2":"54","3":"10"},{"1":"2010-08-06","2":"45","3":"11"},{"1":"2010-08-08","2":"44","3":"3"},{"1":"2010-08-09","2":"51","3":"9"},{"1":"2010-08-10","2":"44","3":"9"},{"1":"2010-08-11","2":"44","3":"5"},{"1":"2010-08-12","2":"80","3":"33"},{"1":"2010-08-13","2":"54","3":"11"},{"1":"2010-08-15","2":"57","3":"4"},{"1":"2010-08-16","2":"38","3":"11"},{"1":"2010-08-17","2":"45","3":"19"},{"1":"2010-08-18","2":"57","3":"2"},{"1":"2010-08-19","2":"77","3":"7"},{"1":"2010-08-20","2":"58","3":"4"},{"1":"2010-08-22","2":"60","3":"4"},{"1":"2010-08-23","2":"45","3":"14"},{"1":"2010-08-24","2":"61","3":"11"},{"1":"2010-08-25","2":"76","3":"14"},{"1":"2010-08-26","2":"78","3":"9"},{"1":"2010-08-27","2":"34","3":"1"},{"1":"2010-08-29","2":"39","3":"1"},{"1":"2010-08-31","2":"61","3":"7"},{"1":"2010-09-01","2":"42","3":"39"},{"1":"2010-09-02","2":"86","3":"6"},{"1":"2010-09-03","2":"60","3":"14"},{"1":"2010-09-05","2":"35","3":"1"},{"1":"2010-09-06","2":"53","3":"8"},{"1":"2010-09-07","2":"51","3":"4"},{"1":"2010-09-08","2":"46","3":"4"},{"1":"2010-09-09","2":"65","3":"17"},{"1":"2010-09-10","2":"45","3":"4"},{"1":"2010-09-12","2":"48","3":"1"},{"1":"2010-09-13","2":"86","3":"18"},{"1":"2010-09-14","2":"61","3":"2"},{"1":"2010-09-15","2":"66","3":"7"},{"1":"2010-09-16","2":"66","3":"24"},{"1":"2010-09-17","2":"51","3":"24"},{"1":"2010-09-19","2":"59","3":"1"},{"1":"2010-09-20","2":"75","3":"10"},{"1":"2010-09-21","2":"103","3":"33"},{"1":"2010-09-22","2":"82","3":"2"},{"1":"2010-09-23","2":"84","3":"4"},{"1":"2010-09-24","2":"61","3":"2"},{"1":"2010-09-26","2":"65","3":"10"},{"1":"2010-09-27","2":"85","3":"6"},{"1":"2010-09-28","2":"127","3":"44"},{"1":"2010-09-29","2":"97","3":"13"},{"1":"2010-09-30","2":"90","3":"21"},{"1":"2010-10-01","2":"69","3":"14"},{"1":"2010-10-03","2":"76","3":"13"},{"1":"2010-10-04","2":"84","3":"6"},{"1":"2010-10-05","2":"117","3":"43"},{"1":"2010-10-06","2":"61","3":"5"},{"1":"2010-10-07","2":"114","3":"28"},{"1":"2010-10-08","2":"75","3":"20"},{"1":"2010-10-10","2":"68","3":"3"},{"1":"2010-10-11","2":"90","3":"19"},{"1":"2010-10-12","2":"110","3":"30"},{"1":"2010-10-13","2":"83","3":"12"},{"1":"2010-10-14","2":"98","3":"15"},{"1":"2010-10-15","2":"108","3":"4"},{"1":"2010-10-17","2":"71","3":"9"},{"1":"2010-10-18","2":"103","3":"34"},{"1":"2010-10-19","2":"75","3":"14"},{"1":"2010-10-20","2":"106","3":"9"},{"1":"2010-10-21","2":"94","3":"20"},{"1":"2010-10-22","2":"87","3":"33"},{"1":"2010-10-24","2":"83","3":"3"},{"1":"2010-10-25","2":"72","3":"20"},{"1":"2010-10-26","2":"103","3":"23"},{"1":"2010-10-27","2":"70","3":"4"},{"1":"2010-10-28","2":"61","3":"16"},{"1":"2010-10-29","2":"83","3":"4"},{"1":"2010-10-31","2":"83","3":"5"},{"1":"2010-11-01","2":"59","3":"10"},{"1":"2010-11-02","2":"89","3":"33"},{"1":"2010-11-03","2":"87","3":"18"},{"1":"2010-11-04","2":"131","3":"42"},{"1":"2010-11-05","2":"73","3":"19"},{"1":"2010-11-07","2":"82","3":"8"},{"1":"2010-11-08","2":"80","3":"16"},{"1":"2010-11-09","2":"120","3":"20"},{"1":"2010-11-10","2":"130","3":"20"},{"1":"2010-11-11","2":"128","3":"51"},{"1":"2010-11-12","2":"109","3":"7"},{"1":"2010-11-14","2":"90","3":"4"},{"1":"2010-11-15","2":"102","3":"12"},{"1":"2010-11-16","2":"107","3":"40"},{"1":"2010-11-17","2":"118","3":"14"},{"1":"2010-11-18","2":"104","3":"14"},{"1":"2010-11-19","2":"106","3":"36"},{"1":"2010-11-21","2":"96","3":"6"},{"1":"2010-11-22","2":"92","3":"8"},{"1":"2010-11-23","2":"131","3":"18"},{"1":"2010-11-24","2":"133","3":"52"},{"1":"2010-11-25","2":"151","3":"24"},{"1":"2010-11-26","2":"83","3":"8"},{"1":"2010-11-28","2":"90","3":"12"},{"1":"2010-11-29","2":"106","3":"8"},{"1":"2010-11-30","2":"122","3":"44"},{"1":"2010-12-01","2":"127","3":"5"},{"1":"2010-12-02","2":"141","3":"23"},{"1":"2010-12-03","2":"68","3":"7"},{"1":"2010-12-05","2":"88","3":"6"},{"1":"2010-12-06","2":"102","3":"18"},{"1":"2010-12-07","2":"82","3":"7"},{"1":"2010-12-08","2":"116","3":"22"},{"1":"2010-12-09","2":"106","3":"34"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">InvoiceDay =</span> <span class="fu">as.Date</span>(InvoiceDate)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(InvoiceDay, Status) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Invoices per Day&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(InvoiceDay, <span class="st">`</span><span class="at">Number of Invoices per Day</span><span class="st">`</span>, <span class="at">linetype =</span> Status)) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Number of Invoices per Day, differentiating by Status&quot;</span>) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>From the graph it seems like the cancelled invoices are staying
constant while the confirmed ones are on an upward trend.</p>
<p>We complete this section with the distribution of the number of
invoices per day, both with a table and with a graph, to show the
difference in magnitude between them.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">InvoiceDay =</span> <span class="fu">as.Date</span>(InvoiceDate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(InvoiceDay, Status) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Invoices per Day&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;Number of Invoices per Day&quot;</span>, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">summary</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">&quot;Min.&quot;</span> , <span class="st">&quot;1st Qu.&quot;</span>, <span class="st">&quot;Median&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;3rd Qu.&quot;</span>, <span class="st">&quot;Max.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Statistic, Confirmed, <span class="at">.before =</span> Cancelled)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Statistic"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Confirmed"],"name":[2],"type":["table[1d]"],"align":["right"]},{"label":["Cancelled"],"name":[3],"type":["table[1d]"],"align":["right"]}],"data":[{"1":"Min.","2":"14.00000","3":"0.00000"},{"1":"1st Qu.","2":"49.00000","3":"5.00000"},{"1":"Median","2":"62.00000","3":"9.00000"},{"1":"Mean","2":"67.01303","3":"13.37785"},{"1":"3rd Qu.","2":"82.00000","3":"19.00000"},{"1":"Max.","2":"151.00000","3":"55.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">InvoiceDay =</span> <span class="fu">as.Date</span>(InvoiceDate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(InvoiceDay, Status) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Invoices per Day&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">Number of Invoices per Day</span><span class="st">`</span>, <span class="at">linetype =</span> Status)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Probability Distributions of Invoices per Day, differentiating by Status&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="number-of-distinct-items" class="section level1">
<h1>- <em>number of distinct items</em></h1>
<p>Then we want to investigate the differences in homogeneity and we can
see that cancelled invoices generally contain less distinct items.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Distinct Items&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(StockCode), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Status, <span class="at">values_from =</span> <span class="st">`</span><span class="at">Number of Distinct Items</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#we didn&#39;t substitute NAs with O with `values_fill = 0` as it would incorrectly modify the summary table, adding values that don&#39;t exist </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">summary</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#to remove the last line from the summary table, the one with NAs</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">&quot;Min.&quot;</span> , <span class="st">&quot;1st Qu.&quot;</span>, <span class="st">&quot;Median&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;3rd Qu.&quot;</span>, <span class="st">&quot;Max.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Statistic, Confirmed, <span class="at">.before =</span> Cancelled) </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Statistic"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Confirmed"],"name":[2],"type":["table[1d]"],"align":["right"]},{"label":["Cancelled"],"name":[3],"type":["table[1d]"],"align":["right"]}],"data":[{"1":"Min.","2":"1.0000","3":"1.000000"},{"1":"1st Qu.","2":"6.0000","3":"1.000000"},{"1":"Median","2":"15.0000","3":"1.000000"},{"1":"Mean","2":"24.1169","3":"2.320185"},{"1":"3rd Qu.","2":"28.0000","3":"2.000000"},{"1":"Max.","2":"673.0000","3":"45.000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Number of Distinct Items&quot;</span> <span class="ot">=</span> <span class="fu">n_distinct</span>(StockCode), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Status, <span class="st">`</span><span class="at">Number of Distinct Items</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Distributions of the Number of Distinct Items per Invoice, differentiating by Status, </span><span class="sc">\n</span><span class="st"> Logarithmic Scale&quot;</span>)</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="differences-in-quantity" class="section level1">
<h1>- <em>differences in quantity</em></h1>
<p>We proceed analogously for the <code>Quantity</code> column,
calculating the total quantities for each invoice, in absolute values
(as cancelled invoices have negative ones).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Quantity&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;Total Quantity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#we didn&#39;t substitute NAs with O with `values_fill = 0` as it would incorrectly modify the summary table, adding values that don&#39;t exist </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">summary</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#to remove the last line from the summary table, the one with NAs</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">&quot;Min.&quot;</span> , <span class="st">&quot;1st Qu.&quot;</span>, <span class="st">&quot;Median&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;3rd Qu.&quot;</span>, <span class="st">&quot;Max.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Statistic, Confirmed, <span class="at">.before =</span> Cancelled)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Statistic"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Confirmed"],"name":[2],"type":["table[1d]"],"align":["right"]},{"label":["Cancelled"],"name":[3],"type":["table[1d]"],"align":["right"]}],"data":[{"1":"Min.","2":"1.000","3":"1.00000"},{"1":"1st Qu.","2":"64.000","3":"2.00000"},{"1":"Median","2":"144.000","3":"4.00000"},{"1":"Mean","2":"283.168","3":"51.09861"},{"1":"3rd Qu.","2":"282.000","3":"10.00000"},{"1":"Max.","2":"87167.000","3":"87167.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Quantity&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Status, <span class="st">`</span><span class="at">Total Quantity</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Distributions of Quantity per Invoice, differentiating by Status, </span><span class="sc">\n</span><span class="st"> Logarithmic Scale&quot;</span>)</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>And we can see that cancelled invoices are, again, generally
smaller.</p>
<p>The same <code>Max</code>. value for both statuses piqued our
interest and we found out that three invoices share it.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Invoice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C524235&quot;</span>, <span class="st">&quot;518505&quot;</span>, <span class="st">&quot;524174&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Invoice, <span class="at">wt =</span> <span class="fu">abs</span>(Quantity), <span class="at">name =</span> <span class="st">&quot;Total Quantity&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Invoice"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Total Quantity"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"518505","2":"87167"},{"1":"524174","2":"87167"},{"1":"C524235","2":"87167"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>It is not by chance that it happened, as all three contain the same
items in the same quantities and two of them are made by the same
customer, very curious.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Invoice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C524235&quot;</span>, <span class="st">&quot;518505&quot;</span>, <span class="st">&quot;524174&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(StockCode)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Invoice"],"name":[1],"type":["chr"],"align":["left"]},{"label":["StockCode"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Quantity"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["InvoiceDate"],"name":[5],"type":["dttm"],"align":["right"]},{"label":["Price"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["CustomerID"],"name":[7],"type":["chr"],"align":["left"]},{"label":["Country"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"518505","2":"10123C","3":"HEARTS WRAPPING TAPE","4":"144","5":"2010-08-09 13:10:00","6":"0.06","7":"14277","8":"France"},{"1":"524174","2":"10123C","3":"HEARTS WRAPPING TAPE","4":"144","5":"2010-09-27 16:30:00","6":"0.06","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"10123C","3":"HEARTS WRAPPING TAPE","4":"-144","5":"2010-09-28 11:02:00","6":"0.06","7":"14277","8":"France"},{"1":"518505","2":"10123G","3":"ARMY CAMO WRAPPING TAPE","4":"1104","5":"2010-08-09 13:10:00","6":"0.06","7":"14277","8":"France"},{"1":"524174","2":"10123G","3":"ARMY CAMO WRAPPING TAPE","4":"1104","5":"2010-09-27 16:30:00","6":"0.06","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"10123G","3":"ARMY CAMO WRAPPING TAPE","4":"-1104","5":"2010-09-28 11:02:00","6":"0.06","7":"14277","8":"France"},{"1":"518505","2":"16043","3":"POP ART PUSH DOWN RUBBER","4":"960","5":"2010-08-09 13:10:00","6":"0.06","7":"14277","8":"France"},{"1":"524174","2":"16043","3":"POP ART PUSH DOWN RUBBER","4":"960","5":"2010-09-27 16:30:00","6":"0.06","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16043","3":"POP ART PUSH DOWN RUBBER","4":"-960","5":"2010-09-28 11:02:00","6":"0.06","7":"14277","8":"France"},{"1":"518505","2":"16046","3":"TEATIME PEN CASE & PENS","4":"4608","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"16046","3":"TEATIME PEN CASE & PENS","4":"4608","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16046","3":"TEATIME PEN CASE & PENS","4":"-4608","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"16047","3":"POP ART PEN CASE & PENS","4":"5184","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"16047","3":"POP ART PEN CASE & PENS","4":"5184","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16047","3":"POP ART PEN CASE & PENS","4":"-5184","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"16053","3":"POPART COL BALLPOINT PEN ASST","4":"2000","5":"2010-08-09 13:10:00","6":"0.03","7":"14277","8":"France"},{"1":"524174","2":"16053","3":"POPART COL BALLPOINT PEN ASST","4":"2000","5":"2010-09-27 16:30:00","6":"0.03","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16053","3":"POPART COL BALLPOINT PEN ASST","4":"-2000","5":"2010-09-28 11:02:00","6":"0.03","7":"14277","8":"France"},{"1":"518505","2":"16162L","3":"THE KING GIFT BAG","4":"3744","5":"2010-08-09 13:10:00","6":"0.05","7":"14277","8":"France"},{"1":"524174","2":"16162L","3":"THE KING GIFT BAG","4":"3744","5":"2010-09-27 16:30:00","6":"0.05","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16162L","3":"THE KING GIFT BAG","4":"-3744","5":"2010-09-28 11:02:00","6":"0.05","7":"14277","8":"France"},{"1":"518505","2":"16202A","3":"PASTEL PINK PHOTO ALBUM","4":"300","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"16202A","3":"PASTEL PINK PHOTO ALBUM","4":"300","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16202A","3":"PASTEL PINK PHOTO ALBUM","4":"-300","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"16202B","3":"PASTEL BLUE PHOTO ALBUM","4":"444","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"16202B","3":"PASTEL BLUE PHOTO ALBUM","4":"444","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"16202B","3":"PASTEL BLUE PHOTO ALBUM","4":"-444","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"20661","3":"BLUE SPOTTY PURSE","4":"300","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"20661","3":"BLUE POLKADOT PURSE","4":"300","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"20661","3":"BLUE POLKADOT PURSE","4":"-300","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"20662","3":"FIRST CLASS HOLIDAY PURSE","4":"300","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"20662","3":"FIRST CLASS HOLIDAY PURSE","4":"300","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"20662","3":"FIRST CLASS HOLIDAY PURSE","4":"-300","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"20663","3":"QUEEN OF THE SKIES HOLIDAY PURSE","4":"500","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"20663","3":"QUEEN OF THE SKIES HOLIDAY PURSE","4":"500","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"20663","3":"QUEEN OF THE SKIES HOLIDAY PURSE","4":"-500","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"20666","3":"ECONOMY HOLIDAY PURSE","4":"400","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"20666","3":"ECONOMY HOLIDAY PURSE","4":"400","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"20666","3":"ECONOMY HOLIDAY PURSE","4":"-400","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"20670","3":"VIP HOLIDAY PURSE","4":"300","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"20670","3":"VIP HOLIDAY PURSE","4":"300","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"20670","3":"VIP HOLIDAY PURSE","4":"-300","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"21082","3":"SET/20 FRUIT SALAD PAPER NAPKINS","4":"3072","5":"2010-08-09 13:10:00","6":"0.17","7":"14277","8":"France"},{"1":"524174","2":"21082","3":"SET/20 FRUIT SALAD PAPER NAPKINS","4":"3072","5":"2010-09-27 16:30:00","6":"0.17","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21082","3":"SET/20 FRUIT SALAD PAPER NAPKINS","4":"-3072","5":"2010-09-28 11:02:00","6":"0.17","7":"14277","8":"France"},{"1":"518505","2":"21088","3":"SET/6 FRUIT SALAD PAPER CUPS","4":"7128","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"21088","3":"SET/6 FRUIT SALAD PAPER CUPS","4":"7128","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21088","3":"SET/6 FRUIT SALAD PAPER CUPS","4":"-7128","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"21096","3":"SET/6 FRUIT SALAD  PAPER PLATES","4":"7008","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"21096","3":"SET/6 FRUIT SALAD  PAPER PLATES","4":"7008","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21096","3":"SET/6 FRUIT SALAD  PAPER PLATES","4":"-7008","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"21278","3":"VINTAGE KITCHEN PRINT PUDDINGS","4":"1200","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"21278","3":"VINTAGE KITCHEN PRINT PUDDINGS","4":"1200","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21278","3":"VINTAGE KITCHEN PRINT PUDDINGS","4":"-1200","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"518505","2":"21279","3":"VINTAGE KITCHEN PRINT FRUITS","4":"1632","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"21279","3":"VINTAGE KITCHEN PRINT FRUITS","4":"1632","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21279","3":"VINTAGE KITCHEN PRINT FRUITS","4":"-1632","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"518505","2":"21280","3":"VINTAGE KITCHEN PRINT VEGETABLES","4":"1248","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"21280","3":"VINTAGE KITCHEN PRINT VEGETABLES","4":"1248","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21280","3":"VINTAGE KITCHEN PRINT VEGETABLES","4":"-1248","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"518505","2":"21281","3":"VINTAGE KITCHEN PRINT SEAFOOD","4":"1536","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"21281","3":"VINTAGE KITCHEN PRINT SEAFOOD","4":"1536","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21281","3":"VINTAGE KITCHEN PRINT SEAFOOD","4":"-1536","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"518505","2":"21336","3":"GOLD WASHBAG","4":"864","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"21336","3":"GOLD WASHBAG","4":"864","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21336","3":"GOLD WASHBAG","4":"-864","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"21392","3":"RED SPOTTY PUDDING BOWL","4":"3648","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"21392","3":"RED POLKADOT PUDDING BOWL","4":"3648","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21392","3":"RED POLKADOT PUDDING BOWL","4":"-3648","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"21393","3":"BLUE  SPOTTY PUDDING BOWL","4":"2496","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"21393","3":"BLUE POLKADOT PUDDING BOWL","4":"2496","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"21393","3":"BLUE POLKADOT PUDDING BOWL","4":"-2496","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"37340","3":"MULTICOLOUR SPRING FLOWER MUG","4":"4992","5":"2010-08-09 13:10:00","6":"0.10","7":"14277","8":"France"},{"1":"524174","2":"37340","3":"MULTICOLOUR SPRING FLOWER MUG","4":"4992","5":"2010-09-27 16:30:00","6":"0.10","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37340","3":"MULTICOLOUR SPRING FLOWER MUG","4":"-4992","5":"2010-09-28 11:02:00","6":"0.10","7":"14277","8":"France"},{"1":"518505","2":"37423","3":"WHITE WITH BLACK CATS PLATE","4":"2952","5":"2010-08-09 13:10:00","6":"0.10","7":"14277","8":"France"},{"1":"524174","2":"37423","3":"WHITE WITH BLACK CATS PLATE","4":"2952","5":"2010-09-27 16:30:00","6":"0.10","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37423","3":"WHITE WITH BLACK CATS PLATE","4":"-2952","5":"2010-09-28 11:02:00","6":"0.10","7":"14277","8":"France"},{"1":"518505","2":"37424","3":"WHITE WITH BLACK CATS MUG","4":"2112","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"37424","3":"WHITE WITH BLACK CATS MUG","4":"2112","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37424","3":"WHITE WITH BLACK CATS MUG","4":"-2112","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"37444A","3":"YELLOW BREAKFAST CUP AND SAUCER","4":"1308","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"37444A","3":"YELLOW BREAKFAST CUP AND SAUCER","4":"1308","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37444A","3":"YELLOW BREAKFAST CUP AND SAUCER","4":"-1308","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"37444B","3":"BLUE BREAKFAST CUP AND SAUCER","4":"984","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"37444B","3":"BLUE BREAKFAST CUP AND SAUCER","4":"984","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37444B","3":"BLUE BREAKFAST CUP AND SAUCER","4":"-984","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"37444C","3":"PINK BREAKFAST CUP AND SAUCER","4":"768","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"37444C","3":"PINK BREAKFAST CUP AND SAUCER","4":"768","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37444C","3":"PINK BREAKFAST CUP AND SAUCER","4":"-768","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"37471","3":"MULTICOLOUR DOTS PLATE","4":"684","5":"2010-08-09 13:10:00","6":"0.10","7":"14277","8":"France"},{"1":"524174","2":"37471","3":"MULTICOLOUR POLKADOT PLATE","4":"684","5":"2010-09-27 16:30:00","6":"0.10","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"37471","3":"MULTICOLOUR POLKADOT PLATE","4":"-684","5":"2010-09-28 11:02:00","6":"0.10","7":"14277","8":"France"},{"1":"518505","2":"84493","3":"BLUE/PINK NEST STRIPE BOX","4":"567","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"84493","3":"BLUE/PINK NEST STRIPE BOX","4":"567","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84493","3":"BLUE/PINK NEST STRIPE BOX","4":"-567","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"84842","3":"HELLO SAILOR BATHROOM SET","4":"720","5":"2010-08-09 13:10:00","6":"0.33","7":"14277","8":"France"},{"1":"524174","2":"84842","3":"HELLO SAILOR BATHROOM SET","4":"720","5":"2010-09-27 16:30:00","6":"0.33","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84842","3":"HELLO SAILOR BATHROOM SET","4":"-720","5":"2010-09-28 11:02:00","6":"0.33","7":"14277","8":"France"},{"1":"518505","2":"84847","3":"FLORAL BATHROOM SET","4":"1116","5":"2010-08-09 13:10:00","6":"0.33","7":"14277","8":"France"},{"1":"524174","2":"84847","3":"FLORAL BATHROOM SET","4":"1116","5":"2010-09-27 16:30:00","6":"0.33","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84847","3":"FLORAL BATHROOM SET","4":"-1116","5":"2010-09-28 11:02:00","6":"0.33","7":"14277","8":"France"},{"1":"518505","2":"84924D","3":"LA PALMIERA METAL SIGN CALENDAR","4":"372","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"84924D","3":"LA PALMIERA METAL SIGN CALENDAR","4":"372","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"518505","2":"84924F","3":"PSYCHEDELIC METAL SIGN CALENDAR","4":"480","5":"2010-08-09 13:10:00","6":"0.25","7":"14277","8":"France"},{"1":"524174","2":"84924F","3":"PSYCHEDELIC METAL SIGN CALENDAR","4":"480","5":"2010-09-27 16:30:00","6":"0.25","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84924F","3":"PSYCHEDELIC METAL SIGN CALENDAR","4":"-480","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"C524235","2":"84925D","3":"LA PALMIERA WALL THERMOMETER","4":"-372","5":"2010-09-28 11:02:00","6":"0.25","7":"14277","8":"France"},{"1":"518505","2":"84927A","3":"WAKE UP COCKEREL TILE HOOK","4":"72","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"84927A","3":"WAKE UP COCKEREL TILE HOOK","4":"72","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84927A","3":"WAKE UP COCKEREL TILE HOOK","4":"-72","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"84927D","3":"LA PALMIERA TILE HOOK","4":"432","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"84927D","3":"LA PALMIERA TILE HOOK","4":"432","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84927D","3":"LA PALMIERA TILE HOOK","4":"-432","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"84927E","3":"FLOWERS TILE HOOK","4":"192","5":"2010-08-09 13:10:00","6":"0.08","7":"14277","8":"France"},{"1":"524174","2":"84927E","3":"FLOWERS TILE HOOK","4":"192","5":"2010-09-27 16:30:00","6":"0.08","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"84927E","3":"FLOWERS TILE HOOK","4":"-192","5":"2010-09-28 11:02:00","6":"0.08","7":"14277","8":"France"},{"1":"518505","2":"85006","3":"SET 4 NURSERY DES ROUND BOXES","4":"1440","5":"2010-08-09 13:10:00","6":"0.31","7":"14277","8":"France"},{"1":"524174","2":"85006","3":"SET 4 NURSERY DES ROUND BOXES","4":"1440","5":"2010-09-27 16:30:00","6":"0.31","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85006","3":"SET 4 NURSERY DES ROUND BOXES","4":"-1440","5":"2010-09-28 11:02:00","6":"0.31","7":"14277","8":"France"},{"1":"518505","2":"85109","3":"PINK BOUDOIR T-LIGHT HOLDER","4":"1872","5":"2010-08-09 13:10:00","6":"0.07","7":"14277","8":"France"},{"1":"524174","2":"85109","3":"PINK BOUDOIR T-LIGHT HOLDER","4":"1872","5":"2010-09-27 16:30:00","6":"0.07","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85109","3":"PINK BOUDOIR T-LIGHT HOLDER","4":"-1872","5":"2010-09-28 11:02:00","6":"0.07","7":"14277","8":"France"},{"1":"518505","2":"85110","3":"BLACK SILVER FLOWER T-LIGHT HOLDER","4":"4752","5":"2010-08-09 13:10:00","6":"0.07","7":"14277","8":"France"},{"1":"524174","2":"85110","3":"BLACK SILVER FLOWER T-LIGHT HOLDER","4":"4752","5":"2010-09-27 16:30:00","6":"0.07","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85110","3":"BLACK SILVER FLOWER T-LIGHT HOLDER","4":"-4752","5":"2010-09-28 11:02:00","6":"0.07","7":"14277","8":"France"},{"1":"518505","2":"85160A","3":"WHITE BIRD GARDEN DESIGN MUG","4":"4320","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"85160A","3":"WHITE BIRD GARDEN DESIGN MUG","4":"4320","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85160A","3":"WHITE BIRD GARDEN DESIGN MUG","4":"-4320","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"85160B","3":"BLACK BIRD GARDEN DESIGN MUG","4":"2976","5":"2010-08-09 13:10:00","6":"0.13","7":"14277","8":"France"},{"1":"524174","2":"85160B","3":"BLACK BIRD GARDEN DESIGN MUG","4":"2976","5":"2010-09-27 16:30:00","6":"0.13","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85160B","3":"BLACK BIRD GARDEN DESIGN MUG","4":"-2976","5":"2010-09-28 11:02:00","6":"0.13","7":"14277","8":"France"},{"1":"518505","2":"85184D","3":"S/4 BLUE ROUND DECOUPAGE BOXES","4":"3936","5":"2010-08-09 13:10:00","6":"0.42","7":"14277","8":"France"},{"1":"524174","2":"85184D","3":"S/4 BLUE ROUND DECOUPAGE BOXES","4":"3936","5":"2010-09-27 16:30:00","6":"0.42","7":"13687","8":"United Kingdom"},{"1":"C524235","2":"85184D","3":"S/4 BLUE ROUND DECOUPAGE BOXES","4":"-3936","5":"2010-09-28 11:02:00","6":"0.42","7":"14277","8":"France"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><br></p>
</div>
<div id="differences-in-revenues" class="section level1">
<h1>- <em>differences in revenues</em></h1>
<p>Besides being comprised of less distinct items and in smaller
quantities, cancelled invoices are of smaller absolute monetary value as
well.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Value&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity <span class="sc">*</span> Price)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;Total Value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#we didn&#39;t substitute NAs with O with `values_fill = 0` as it would incorrectly modify the summary table, adding values that don&#39;t exist </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">summary</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#to remove the last line from the summary table, the one with NAs</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">&quot;Min.&quot;</span> , <span class="st">&quot;1st Qu.&quot;</span>, <span class="st">&quot;Median&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;3rd Qu.&quot;</span>, <span class="st">&quot;Max.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Statistic, Confirmed, <span class="at">.before =</span> Cancelled)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Statistic"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Confirmed"],"name":[2],"type":["table[1d]"],"align":["right"]},{"label":["Cancelled"],"name":[3],"type":["table[1d]"],"align":["right"]}],"data":[{"1":"Min.","2":"0.190","3":"0.42000"},{"1":"1st Qu.","2":"149.100","3":"7.95000"},{"1":"Median","2":"299.820","3":"16.30000"},{"1":"Mean","2":"478.288","3":"60.36069"},{"1":"3rd Qu.","2":"486.400","3":"34.95000"},{"1":"Max.","2":"49844.990","3":"11880.84000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Invoice, Status) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Value&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity <span class="sc">*</span> Price)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Status, <span class="st">`</span><span class="at">Total Value</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Distributions of Revenues per Invoice, differentiating by Status, </span><span class="sc">\n</span><span class="st"> Logarithmic Scale&quot;</span>)</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The total loss in revenues can be quantified to
<code>247901.4 £</code>, <code>2.46%</code> over the hypothetical
revenues those invoices had not been cancelled.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total Revenues&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity) <span class="sc">*</span> Price),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Lost Revenues&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Quantity[<span class="fu">str_starts</span>(Invoice, <span class="st">&quot;C&quot;</span>)]) <span class="sc">*</span> Price[<span class="fu">str_starts</span>(Invoice, <span class="st">&quot;C&quot;</span>)]),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Percentage =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">Lost Revenues</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Total Revenues</span><span class="st">`</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Total Revenues"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Lost Revenues"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Percentage"],"name":[3],"type":["formttbl"],"align":["right"]}],"data":[{"1":"10087720","2":"247901.4","3":"2.46%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><br></p>
</div>
<div id="country-breakdown" class="section level1">
<h1>- <em>country breakdown</em></h1>
<p>Let’s look now at the number of invoices per country, where we see
that more than <code>9</code> invoices out of <code>10</code> pertain to
<code>United Kingdom</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country, <span class="at">wt =</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">&quot;Number of Invoices&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span>)))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Number of Invoices"],"name":[2],"type":["int"],"align":["right"]},{"label":["Percentage"],"name":[3],"type":["formttbl"],"align":["right"]}],"data":[{"1":"United Kingdom","2":"22733","3":"92.11%"},{"1":"Germany","2":"478","3":"1.94%"},{"1":"EIRE","2":"391","3":"1.58%"},{"1":"France","2":"280","3":"1.13%"},{"1":"Netherlands","2":"132","3":"0.53%"},{"1":"Sweden","2":"72","3":"0.29%"},{"1":"Spain","2":"70","3":"0.28%"},{"1":"Belgium","2":"56","3":"0.23%"},{"1":"Portugal","2":"54","3":"0.22%"},{"1":"Channel Islands","2":"45","3":"0.18%"},{"1":"Switzerland","2":"44","3":"0.18%"},{"1":"Australia","2":"43","3":"0.17%"},{"1":"Italy","2":"33","3":"0.13%"},{"1":"Denmark","2":"31","3":"0.13%"},{"1":"Japan","2":"30","3":"0.12%"},{"1":"Austria","2":"25","3":"0.10%"},{"1":"Cyprus","2":"25","3":"0.10%"},{"1":"Finland","2":"16","3":"0.06%"},{"1":"Greece","2":"15","3":"0.06%"},{"1":"Poland","2":"15","3":"0.06%"},{"1":"United Arab Emirates","2":"15","3":"0.06%"},{"1":"USA","2":"14","3":"0.06%"},{"1":"NA","2":"13","3":"0.05%"},{"1":"Norway","2":"9","3":"0.04%"},{"1":"Bahrain","2":"8","3":"0.03%"},{"1":"Lithuania","2":"6","3":"0.02%"},{"1":"Singapore","2":"4","3":"0.02%"},{"1":"Korea","2":"3","3":"0.01%"},{"1":"Canada","2":"2","3":"0.01%"},{"1":"Hong Kong","2":"2","3":"0.01%"},{"1":"Iceland","2":"2","3":"0.01%"},{"1":"Israel","2":"2","3":"0.01%"},{"1":"Malta","2":"2","3":"0.01%"},{"1":"Nigeria","2":"2","3":"0.01%"},{"1":"RSA","2":"2","3":"0.01%"},{"1":"Thailand","2":"2","3":"0.01%"},{"1":"Bermuda","2":"1","3":"0.00%"},{"1":"Brazil","2":"1","3":"0.00%"},{"1":"Lebanon","2":"1","3":"0.00%"},{"1":"West Indies","2":"1","3":"0.00%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country, <span class="at">wt =</span> <span class="fu">n_distinct</span>(Invoice)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(Country, n), n)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Number of Invoices per Country&quot;</span>)</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>It is more interesting to see if some countries cancel invoices more
often than others,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country, Status, <span class="at">wt =</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">name =</span> <span class="st">&quot;Number of Invoices&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span>)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arranging_Column =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#`Arranging_Column` is used to have the Countries with the highest total number of invoices on top  </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Arranging_Column), <span class="fu">desc</span>(Status)) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Arranging_Column)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Status"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Number of Invoices"],"name":[3],"type":["int"],"align":["right"]},{"label":["Percentage"],"name":[4],"type":["formttbl"],"align":["right"]}],"data":[{"1":"United Kingdom","2":"Confirmed","3":"19053","4":"83.81%"},{"1":"United Kingdom","2":"Cancelled","3":"3680","4":"16.19%"},{"1":"Germany","2":"Confirmed","3":"325","4":"67.99%"},{"1":"Germany","2":"Cancelled","3":"153","4":"32.01%"},{"1":"EIRE","2":"Confirmed","3":"309","4":"79.03%"},{"1":"EIRE","2":"Cancelled","3":"82","4":"20.97%"},{"1":"France","2":"Confirmed","3":"227","4":"81.07%"},{"1":"France","2":"Cancelled","3":"53","4":"18.93%"},{"1":"Netherlands","2":"Confirmed","3":"124","4":"93.94%"},{"1":"Netherlands","2":"Cancelled","3":"8","4":"6.06%"},{"1":"Sweden","2":"Confirmed","3":"65","4":"90.28%"},{"1":"Sweden","2":"Cancelled","3":"7","4":"9.72%"},{"1":"Spain","2":"Confirmed","3":"58","4":"82.86%"},{"1":"Spain","2":"Cancelled","3":"12","4":"17.14%"},{"1":"Belgium","2":"Confirmed","3":"46","4":"82.14%"},{"1":"Belgium","2":"Cancelled","3":"10","4":"17.86%"},{"1":"Portugal","2":"Confirmed","3":"39","4":"72.22%"},{"1":"Portugal","2":"Cancelled","3":"15","4":"27.78%"},{"1":"Channel Islands","2":"Confirmed","3":"30","4":"66.67%"},{"1":"Channel Islands","2":"Cancelled","3":"15","4":"33.33%"},{"1":"Switzerland","2":"Confirmed","3":"36","4":"81.82%"},{"1":"Switzerland","2":"Cancelled","3":"8","4":"18.18%"},{"1":"Australia","2":"Confirmed","3":"35","4":"81.40%"},{"1":"Australia","2":"Cancelled","3":"8","4":"18.60%"},{"1":"Italy","2":"Confirmed","3":"25","4":"75.76%"},{"1":"Italy","2":"Cancelled","3":"8","4":"24.24%"},{"1":"Denmark","2":"Confirmed","3":"25","4":"80.65%"},{"1":"Denmark","2":"Cancelled","3":"6","4":"19.35%"},{"1":"Japan","2":"Confirmed","3":"16","4":"53.33%"},{"1":"Japan","2":"Cancelled","3":"14","4":"46.67%"},{"1":"Austria","2":"Confirmed","3":"23","4":"92.00%"},{"1":"Cyprus","2":"Confirmed","3":"21","4":"84.00%"},{"1":"Austria","2":"Cancelled","3":"2","4":"8.00%"},{"1":"Cyprus","2":"Cancelled","3":"4","4":"16.00%"},{"1":"Finland","2":"Confirmed","3":"14","4":"87.50%"},{"1":"Finland","2":"Cancelled","3":"2","4":"12.50%"},{"1":"Greece","2":"Confirmed","3":"13","4":"86.67%"},{"1":"Poland","2":"Confirmed","3":"10","4":"66.67%"},{"1":"United Arab Emirates","2":"Confirmed","3":"10","4":"66.67%"},{"1":"Greece","2":"Cancelled","3":"2","4":"13.33%"},{"1":"Poland","2":"Cancelled","3":"5","4":"33.33%"},{"1":"United Arab Emirates","2":"Cancelled","3":"5","4":"33.33%"},{"1":"USA","2":"Confirmed","3":"11","4":"78.57%"},{"1":"USA","2":"Cancelled","3":"3","4":"21.43%"},{"1":"NA","2":"Confirmed","3":"11","4":"84.62%"},{"1":"NA","2":"Cancelled","3":"2","4":"15.38%"},{"1":"Norway","2":"Confirmed","3":"9","4":"100.00%"},{"1":"Bahrain","2":"Confirmed","3":"7","4":"87.50%"},{"1":"Bahrain","2":"Cancelled","3":"1","4":"12.50%"},{"1":"Lithuania","2":"Confirmed","3":"6","4":"100.00%"},{"1":"Singapore","2":"Confirmed","3":"4","4":"100.00%"},{"1":"Korea","2":"Confirmed","3":"2","4":"66.67%"},{"1":"Korea","2":"Cancelled","3":"1","4":"33.33%"},{"1":"Canada","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Hong Kong","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Iceland","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Israel","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Malta","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Nigeria","2":"Confirmed","3":"1","4":"50.00%"},{"1":"RSA","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Thailand","2":"Confirmed","3":"2","4":"100.00%"},{"1":"Nigeria","2":"Cancelled","3":"1","4":"50.00%"},{"1":"Bermuda","2":"Confirmed","3":"1","4":"100.00%"},{"1":"Brazil","2":"Confirmed","3":"1","4":"100.00%"},{"1":"Lebanon","2":"Confirmed","3":"1","4":"100.00%"},{"1":"West Indies","2":"Confirmed","3":"1","4":"100.00%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>and, among the <code>26</code> countries with cancellations, we can
spot <code>Nigeria</code> and <code>Japan</code> with fairly high rates,
but we have to consider that these two countries don’t have a elevate
number of invoices (just <code>2</code> for the former and
<code>30</code> for the latter).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country, Status, <span class="at">wt =</span> <span class="fu">n_distinct</span>(Invoice), <span class="at">name =</span> <span class="st">&quot;Number of Occurrences&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Number of Invoices&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Number of Occurrences</span><span class="st">`</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Percentage =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">Number of Occurrences</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Number of Occurrences</span><span class="st">`</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status <span class="sc">==</span> <span class="st">&quot;Cancelled&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, <span class="st">`</span><span class="at">Number of Invoices</span><span class="st">`</span>, <span class="st">&quot;Number of Cancellations&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of Occurrences</span><span class="st">`</span>, Percentage)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Number of Invoices"],"name":[2],"type":["int"],"align":["right"]},{"label":["Number of Cancellations"],"name":[3],"type":["int"],"align":["right"]},{"label":["Percentage"],"name":[4],"type":["formttbl"],"align":["right"]}],"data":[{"1":"Nigeria","2":"2","3":"1","4":"50.00%"},{"1":"Japan","2":"30","3":"14","4":"46.67%"},{"1":"Channel Islands","2":"45","3":"15","4":"33.33%"},{"1":"Korea","2":"3","3":"1","4":"33.33%"},{"1":"Poland","2":"15","3":"5","4":"33.33%"},{"1":"United Arab Emirates","2":"15","3":"5","4":"33.33%"},{"1":"Germany","2":"478","3":"153","4":"32.01%"},{"1":"Portugal","2":"54","3":"15","4":"27.78%"},{"1":"Italy","2":"33","3":"8","4":"24.24%"},{"1":"USA","2":"14","3":"3","4":"21.43%"},{"1":"EIRE","2":"391","3":"82","4":"20.97%"},{"1":"Denmark","2":"31","3":"6","4":"19.35%"},{"1":"France","2":"280","3":"53","4":"18.93%"},{"1":"Australia","2":"43","3":"8","4":"18.60%"},{"1":"Switzerland","2":"44","3":"8","4":"18.18%"},{"1":"Belgium","2":"56","3":"10","4":"17.86%"},{"1":"Spain","2":"70","3":"12","4":"17.14%"},{"1":"United Kingdom","2":"22733","3":"3680","4":"16.19%"},{"1":"Cyprus","2":"25","3":"4","4":"16.00%"},{"1":"NA","2":"13","3":"2","4":"15.38%"},{"1":"Greece","2":"15","3":"2","4":"13.33%"},{"1":"Bahrain","2":"8","3":"1","4":"12.50%"},{"1":"Finland","2":"16","3":"2","4":"12.50%"},{"1":"Sweden","2":"72","3":"7","4":"9.72%"},{"1":"Austria","2":"25","3":"2","4":"8.00%"},{"1":"Netherlands","2":"132","3":"8","4":"6.06%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>This graph reflects that, as the y axis is ordered, after
<code>NA</code>, by the number of invoices.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">if_else</span>(<span class="fu">str_detect</span>(Invoice, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;Cancelled&quot;</span>, <span class="st">&quot;Confirmed&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country, Status, <span class="at">wt =</span> <span class="fu">n_distinct</span>(Invoice)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> formattable<span class="sc">::</span><span class="fu">percent</span>(n <span class="sc">/</span> <span class="fu">sum</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(Country, n), perc, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Cancellation Rates per Country&quot;</span>) <span class="sc">+</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Investigating_Invoices_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="main-takeaways" class="section level1">
<h1>- <em>main takeaways</em></h1>
<ul>
<li>Cancelled invoices, being <code>16.64%</code> of the total, are a
not negligible phenomenon</li>
<li>Their daily occurrence stayed constant during last year while
confirmed ones are on a rising trend</li>
<li>Compared to the confirmed ones, they are generally smaller in terms
of distinct items, total quantity and revenue</li>
<li>The loss in revenue can be quantified to <code>247901.4 £</code>,
the <code>2.46%</code></li>
<li>The market is mainly based in the <code>United Kingdom</code>, among
other countries <code>Nigeria</code> and <code>Japan</code> have high
cancellation rate, but are not very active customers</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
